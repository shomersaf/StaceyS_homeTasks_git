//declaring
let courses =[];
let CURRENT ={
  cName:null,
  cPrice:null,
}
let counter = 0;
const sendButton = document.querySelector(".sendButton");
sendButton.addEventListener("click", goGoText);
const clearButton = document.querySelector(".clearButton");
clearButton.addEventListener("click", clearForm);
const container = document.querySelector(".container");
//getting
const form = document.forms["myForm"];
//creating
const table = document.createElement("table");
const tHead = document.createElement("thead");
const tHName = document.createElement("th");
const tHPrice = document.createElement("th");
const tHActions = document.createElement("th");
const tBody = document.createElement("tbody");
//appending
container.append(table);
//naming
tHName.innerText = "Name";
tHPrice.innerText = "Price";
tHActions.innerText = "Actions";

//functions
function goGoText(){
//declaring 
tHead.append(tHName, tHPrice, tHActions);
table.append(tHead, tBody);
const tRow = document.createElement("tr");
const tdName = document.createElement("td");
const tdPrice = document.createElement("td");
const tdActions = document.createElement("td");
//getting

CURRENT.cName = form.elements["courseName"];

CURRENT.cPrice = form.elements["coursePrice"];
courses.push({
  cName: CURRENT.cName.value,
  cPrice: CURRENT.cPrice.value,
});

tdName.innerText = courses[counter].cName;
tdPrice.innerText = courses[counter].cPrice;

//buttons
const delButton = document.createElement("button");
delButton.innerText = " X ";
delButton.className = "delRowButton";
delButton.addEventListener("click", delCourse)
tdActions.append(delButton);
//-------
const editButton = document.createElement("button");
  editButton.className = "editButton";
  editButton.innerText = " edit ";
  editButton.addEventListener("click", editCourse)
  tdActions.append(editButton);
//appending
tRow.append(tdName, tdPrice, tdActions);
tBody.append(tRow);
counter++;
tRow.id = counter;
//cleaning form inputs
CURRENT.cName.value = "";
CURRENT.cPrice.value = "";

}

function clearForm(){
  CURRENT.cName = form.elements["courseName"];
  CURRENT.cPrice = form.elements["coursePrice"];
CURRENT.cName.value = "";
CURRENT.cPrice.value = "";
}

function delCourse(){
 const toDelete =  this.closest('tr');
 let perem =  toDelete.childNodes[0].innerText;
 toDelete.remove();
// CURRENT.cName = form.elements["courseName"];
for (let i = 0; i<courses.length; i++){
  if(courses[i].cName == perem){
    courses.splice(i,1);
    break;
  }
}
}

function editCourse(event){
  const toEdit =  this.closest('tr');
  let perem =  toEdit.childNodes[0].innerText;

  toEdit.innerHTML =" ";
  const newTdName = document.createElement("td");
  const newTdPrice = document.createElement("td");
  const newTdActions = document.createElement("td");

  const newNameInput = document.createElement("input");
  newNameInput.className = "newInput";
  newNameInput.type = "text";
  newNameInput.id = "enteredName_" + toEdit.id;
  newNameInput.value = courses[toEdit.id-1].cName

  const newPriceInput = document.createElement("input");
  newPriceInput.className = "newInput";
  newPriceInput.type = "text";
  newPriceInput.id = "enteredPrice_" + toEdit.id;
  newPriceInput.value = courses[toEdit.id-1].cPrice

  //button
  const saveButton = document.createElement("button");
  saveButton.type="submit";
  saveButton.innerText ="save";
  saveButton.classList.add("editButton", "saveButton");
  saveButton.addEventListener("click", saveEntered);
  newTdName.append(newNameInput);
  newTdPrice.append(newPriceInput);
  newTdActions.append(saveButton);
  toEdit.append(newTdName, newTdPrice, newTdActions);
  inputText = document.querySelector("#enteredName");

  
  for (let i = 0; i<courses.length; i++){
    if(courses[i].cName == perem){
      courses[i].cName = inputText;
      break;
    }
  }
  //courses.splice[counter,1];
  //courses.push(cName);
  //counter++;
}
function saveEntered(){
 
  
  const toEdit =  this.closest('tr');
  let inputNameHtml = document.querySelector("#enteredName_"+toEdit.id)
  courses[toEdit.id-1].cName =  inputNameHtml.value;
  let inputPriceHtml = document.querySelector("#enteredPrice_"+toEdit.id)
  courses[toEdit.id-1].cPrice =  inputPriceHtml.value;
  toEdit.innerHTML =" ";
  
 
 
  
  const newTdName = document.createElement("td");
  const newTdPrice = document.createElement("td");
  const newTdActions = document.createElement("td");

  newTdName.innerText = courses[toEdit.id-1].cName;
  newTdPrice.innerText = courses[toEdit.id-1].cPrice;
 
  const delButton = document.createElement("button");
  delButton.innerText = " X ";
  delButton.className = "delRowButton";
  delButton.addEventListener("click", delCourse)

  const editButton = document.createElement("button");
  editButton.className = "editButton";
  editButton.innerText = " edit ";
  editButton.addEventListener("click", editCourse)
  newTdActions.append(delButton, editButton);
 
  toEdit.append(newTdName, newTdPrice, newTdActions);

}

